# .github/workflows/update-readme.yml
name: Update README


on:
schedule:
- cron: '0 6 * * *' # daily at 06:00 UTC
push:
branches: [ main, master ]
workflow_dispatch: {}


jobs:
build:
runs-on: ubuntu-latest


steps:
- name: Checkout
uses: actions/checkout@v4
with:
persist-credentials: true
fetch-depth: 0


- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: '3.10'


- name: Install dependencies
run: |
python -m pip install --upgrade pip
pip install -r requirements.txt


- name: Generate README
env:
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
PERSONAL_TOKEN: ${{ secrets.PERSONAL_TOKEN }}
GH_USERNAME: ${{ github.repository_owner }}
run: |
python scripts/generate_readme.py


- name: Commit README if changed
id: commit
run: |
git config user.name "github-actions[bot]"
git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
if [ -n "$(git status --porcelain)" ]; then
git add README.md
git commit -m "chore: update README [skip ci]" || echo "no changes to commit"
git push
else
echo "No changes"
fi
